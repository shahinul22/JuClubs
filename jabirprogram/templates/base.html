{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}JU Clubs{% endblock %}</title>

  <!-- Stylesheets -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.20/dist/full.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link href="{% static 'css/output.css' %}" rel="stylesheet">

  <!-- Tailwind Configuration -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'float': 'float 3s ease-in-out infinite',
            'fade-in': 'fadeIn 0.5s ease-out',
            'slide-in': 'slideIn 0.5s ease-out',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-5px)' },
            },
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' },
            },
            slideIn: {
              '0%': { 
                opacity: '0',
                transform: 'translateY(20px)'
              },
              '100%': { 
                opacity: '1',
                transform: 'translateY(0)'
              },
            }
          }
        },
      },
      daisyui: {
        themes: ["light", "dark"],
      },
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/daisyui@4.4.20"></script>
  <style>
    /* Beautiful sign-in button styles */
    .btn-beautiful {
      background: linear-gradient(45deg, #6366f1, #8b5cf6, #ec4899);
      background-size: 200% 200%;
      border: none;
      color: white;
      transition: all 0.4s ease;
      box-shadow: 0 4px 20px rgba(139, 92, 246, 0.4);
      position: relative;
      overflow: hidden;
    }
    
    .btn-beautiful:hover {
      background-position: 100% 100%;
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(139, 92, 246, 0.6);
    }
    
    .btn-beautiful:active {
      transform: translateY(1px);
      box-shadow: 0 2px 15px rgba(139, 92, 246, 0.4);
    }
    
    .btn-beautiful::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: all 0.6s ease;
    }
    
    .btn-beautiful:hover::before {
      left: 100%;
    }
    
    .btn-beautiful i {
      transition: transform 0.3s ease;
    }
    
    .btn-beautiful:hover i {
      transform: translateX(3px);
    }

    /* Hover animations for nav items */
    .nav-link {
      position: relative;
      overflow: hidden;
    }
    
    .nav-link::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, #6366f1, #ec4899);
      transition: width 0.3s ease;
    }
    
    .nav-link:hover::after {
      width: 100%;
    }
    
    /* Profile animation */
    .profile-avatar {
      transition: all 0.3s ease;
    }
    
    .profile-avatar:hover {
      transform: scale(1.05);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.5);
    }
  </style>
</head>

<body class="min-h-screen flex flex-col bg-slate-50 text-gray-800 lg:mx-10 lg:mt-3">
  <div class="drawer">
    <input id="my-drawer" type="checkbox" class="drawer-toggle">

    <div class="drawer-content flex flex-col">
      <!-- Navbar with animations -->
      <nav class="navbar bg-white shadow-sm px-4 mt-1 animate-fade-in">
        <div class="navbar-start">
          <label for="my-drawer" class="btn btn-ghost lg:hidden hover:scale-105 transition-transform">
            <i class="fa-solid fa-bars text-xl"></i>
          </label>
          <a href="#" class="btn btn-ghost text-2xl font-bold flex items-center">
            <img src="{% static 'images/logo-ju-small.png' %}" alt="JU Logo" class="w-10 h-10 mr-2">

            <span class="bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-purple-600">JuClubs</span>
          </a>
        </div>

        <div class="navbar-center hidden lg:flex">
          <ul class="menu menu-horizontal px-1 gap-2">
            <li><a href="#" class="nav-link"><i class="fa-solid fa-house mr-2"></i>Home</a></li>
            <li><a href="#" class="nav-link"><i class="fa-solid fa-users mr-2"></i>Members</a></li>
            <li><a href="#" class="nav-link"><i class="fa-solid fa-calendar-days mr-2"></i>Events</a></li>
          </ul>
        </div>

        <div class="navbar-end space-x-4">
          {% if request.user.is_authenticated or logged_user %}
            <div class="flex items-center space-x-3">
              <!-- Theme Toggle -->
              <div class="tooltip tooltip-bottom" data-tip="Toggle theme">
                <label class="swap swap-rotate hover:scale-110 transition-transform">
                  <input type="checkbox" class="theme-controller" value="dark" />
                  <i class="fa-solid fa-sun swap-off text-xl"></i>
                  <i class="fa-solid fa-moon swap-on text-xl"></i>
                </label>
              </div>

              <!-- Profile Dropdown -->
              <div class="dropdown dropdown-end">
                <div tabindex="0" class="btn btn-ghost btn-circle avatar tooltip tooltip-bottom profile-avatar"
                  data-tip="{% if request.user.is_superuser %}Admin{% else %}{{ logged_user.full_name|default:logged_user.user_username }}{% endif %}">
                  <div class="w-10 h-10 rounded-full bg-gray-200 border-2 border-dashed overflow-hidden flex items-center justify-center text-xl font-bold text-gray-600">
                    {% if request.user.is_superuser %}
                      <img src="{% static 'images/logo-ju-small.png' %}" alt="Admin Logo" class="object-cover w-full h-full" />
                    {% elif logged_user and logged_user.photo %}
                      <img src="{{ logged_user.photo.url }}" alt="{{ logged_user.full_name }}" class="object-cover w-full h-full" />
                    {% elif logged_user %}
                      {{ logged_user.full_name|default:logged_user.user_username|first|upper }}
                    {% else %}
                      {{ request.user.username|first|upper }}
                    {% endif %}
                  </div>
                </div>

                <!-- Dropdown Menu -->
                <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52 animate-slide-in">
                  {% if request.user.is_superuser %}
                    <li><a href="#"><i class="fa-solid fa-user-shield mr-2"></i>Profile</a></li>
                    <li><a href="{% url 'admin_panel:admin_logout_view' %}"><i class="fa-solid fa-arrow-right-from-bracket mr-2"></i>Logout</a></li>
                  {% elif logged_user %}
                    <li><a href="{% url 'user:profile' %}"><i class="fa-solid fa-user mr-2"></i>Profile</a></li>
                    <li><a href="{% url 'user:logout' %}"><i class="fa-solid fa-arrow-right-from-bracket mr-2"></i>Logout</a></li>
                  {% endif %}
                </ul>
              </div>
            </div>
          {% else %}
            <!-- Guest Buttons -->
            <div class="flex items-center space-x-2">
              <!-- Login Dropdown -->
              <div class="dropdown dropdown-end">
                <button class="btn-beautiful flex items-center gap-2 px-6 py-3 rounded-lg">
                  <i class="fa-solid fa-arrow-right-to-bracket"></i>
                  Sign In
                </button>

                <ul class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52 animate-slide-in">
                  <li><a href="{% url 'admin_panel:admin_login_view' %}" class="hover:bg-indigo-50 transition-colors"><i class="fa-solid fa-user-shield mr-2"></i>Admin</a></li>
                  <li><a href="{% url 'user:login' %}" class="hover:bg-indigo-50 transition-colors"><i class="fa-solid fa-user mr-2"></i>User</a></li>
                </ul>
              </div>

              <!-- Register Dropdown -->
              <div class="dropdown dropdown-end">
                <button class="btn btn-secondary flex items-center gap-2 px-6 py-3 rounded-lg transition-all hover:bg-purple-600">
                  <i class="fa-solid fa-user-plus"></i>
                  SignUp
                </button>
                <ul class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52 animate-slide-in">
                  <li><a href="{% url 'user:signup' %}" class="hover:bg-indigo-50 transition-colors"><i class="fa-solid fa-user mr-2"></i>User</a></li>
                </ul>
              </div>
            </div>
          {% endif %}
        </div>
      </nav>

      {% if messages %}
      <div class="fixed top-5 right-5 mr-10 z-50 space-y-2 w-96 max-w-[90vw]">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} shadow-lg animate-slide-in transition-opacity duration-500">
          <div>
            {% if message.tags == 'success' %}<i class="fa-solid fa-circle-check"></i>
            {% elif message.tags == 'error' %}<i class="fa-solid fa-circle-exclamation"></i>
            {% elif message.tags == 'warning' %}<i class="fa-solid fa-triangle-exclamation"></i>
            {% elif message.tags == 'info' %}<i class="fa-solid fa-circle-info"></i>
            {% endif %}
            <span>{{ message }}</span>
          </div>
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <main class="flex-grow p-4 md:p-6 animate-fade-in">
        {% block content %}{% endblock %}
      </main>

      <footer class="bg-white text-center p-4 text-sm text-gray-500 border-t animate-fade-in">
        &copy; {{ now|date:"Y" }} Jahangirnagar University Club Management System
      </footer>
    </div>

    <div class="drawer-side z-50">
      <label for="my-drawer" class="drawer-overlay"></label>
      <div class="flex flex-col justify-between h-full w-80 bg-base-200 relative">
        <label for="my-drawer" class="absolute bg-red-600 rounded-full text-white p-2 right-4 top-4 cursor-pointer hover:bg-white hover:text-red-600 transition-colors">
          <i class="fa-solid fa-xmark text-xl"></i>
        </label>

        <ul class="menu p-4 flex-grow space-y-2 mt-16">
          <li><a href="#" class="nav-link"><i class="fa-solid fa-house mr-2"></i>Home</a></li>
          <li><a href="#" class="nav-link"><i class="fa-solid fa-users mr-2"></i>Members</a></li>
          <li><a href="#" class="nav-link"><i class="fa-solid fa-calendar-days mr-2"></i>Events</a></li>
        </ul>

        <div class="p-4 border-t border-base-300 animate-fade-in">
          {% if not user.is_authenticated %}
            <p class="mb-2 font-semibold text-gray-700">Login Options</p>
            <ul class="menu space-y-1">
              <li><a href="{% url 'admin_panel:admin_login_view' %}" class="hover:bg-indigo-50 transition-colors"><i class="fa-solid fa-user-shield mr-2"></i>Admin Login</a></li>
              <li><a href="{% url 'user:login' %}" class="hover:bg-indigo-50 transition-colors"><i class="fa-solid fa-users mr-2"></i>User Login</a></li>
            </ul>
          {% else %}
            <div class="flex flex-col gap-2">
              {% if club %}
                <a href="{% url 'clubs:club_logout' %}" class="btn btn-error w-full transition-transform hover:scale-[1.02]"><i class="fa-solid fa-arrow-right-from-bracket mr-2"></i>Club Logout</a>
              {% else %}
                <a href="{% url 'admin_panel:admin_logout_view' %}" class="btn btn-error w-full transition-transform hover:scale-[1.02]"><i class="fa-solid fa-arrow-right-from-bracket mr-2"></i>Admin Logout</a>
              {% endif %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <script>
    setTimeout(() => {
      document.querySelectorAll('.alert').forEach(alert => {
        alert.style.opacity = '0';
        setTimeout(() => alert.remove(), 300);
      });
    }, 5000);

    document.addEventListener('DOMContentLoaded', () => {
      const themeToggle = document.querySelector('.theme-controller');
      const currentTheme = localStorage.getItem('theme') || 'light';

      document.documentElement.setAttribute('data-theme', currentTheme);
      if (themeToggle) themeToggle.checked = currentTheme === 'dark';

      if (themeToggle) {
        themeToggle.addEventListener('change', () => {
          const newTheme = themeToggle.checked ? 'dark' : 'light';
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('theme', newTheme);
        });
      }
      
      // Add hover effect to nav links
      const navLinks = document.querySelectorAll('.nav-link');
      navLinks.forEach(link => {
        link.addEventListener('mouseenter', () => {
          link.style.transform = 'translateY(-2px)';
        });
        link.addEventListener('mouseleave', () => {
          link.style.transform = 'translateY(0)';
        });
      });
    });
  </script>
</body>
</html>